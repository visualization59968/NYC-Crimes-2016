</<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title> NYC Crimes 2016</title>
    <link rel="stylesheet" href="style.css" type="text/css" media="screen" />
	<link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
  </head>
  <div id="main-wrapper">

<div id="metrics">
    <!-- <div id="instruct"></div> -->
    <div id="motor">
        <h3>NYC 2016 Crimes</h3>

        <ul>
			<li data-metric="HC01_EST_VC04" class="selected HC01_EST_VC04">Assault</li>
			<li data-metric="HC01_EST_VC05">Burglary</li>
			<li data-metric="HC01_EST_VC10">Drugs</li>
			<li data-metric="HC01_EST_VC11">Grand Larceny</li>
			<li data-metric="HC01_EST_VC12">Murder</li>
			<li data-metric="HC01_EST_VC13">Robbery</li>
			<li data-metric="HC01_EST_VC14">Weapons</li>
        </ul>
        <em>This map shows NYC 2016 Crimes per community district. Click on the crime to activate the layer. Hover over each community district to view statistics. </em>
    </div>

    <div class="clr"></div>
</div>



<div id="tooltip" class="tooltip">
    <h3 class="name"></h3>
    <div data-metric="HC01_EST_VC04" class="line">
        <div class="HC01_EST_VC04 symbol"></div> Assault
        <div class="HC01_EST_VC04_val moe"></div>
        <div class="HC01_EST_VC04_val val"></div>
    </div>

    <div data-metric="HC01_EST_VC05" class="line">
      <div class="HC01_EST_VC05 symbol"></div> Burglary
      <div class="HC01_EST_VC05_val moe"></div>
      <div class="HC01_EST_VC05_val val"></div>
    </div>

    <div data-metric="HC01_EST_VC10" class="line">
        <div class="HC01_EST_VC10 symbol"></div> Drugs
        <div class="HC01_EST_VC10_val moe"></div>
        <div class="HC01_EST_VC10_val val"></div>
    </div>

    <div data-metric="HC01_EST_VC11" class="line">
        <div class="HC01_EST_VC11 symbol"></div> Grand Larceny
        <div class="HC01_EST_VC11_val moe"></div>
        <div class="HC01_EST_VC11_val val"></div>
    </div>

    <div data-metric="HC01_EST_VC12" class="line">
      <div class="HC01_EST_VC12 symbol"></div> Murder
      <div class="HC01_EST_VC12_val moe"></div>
      <div class="HC01_EST_VC12_val val"></div>
  </div>

  <div data-metric="HC01_EST_VC13" class="line">
      <div class="HC01_EST_VC13 symbol"></div> Robbery
      <div class="HC01_EST_VC13_val moe"></div>
      <div class="HC01_EST_VC13_val val"></div>
    </div>

  <div data-metric="HC01_EST_VC14" class="line">
      <div class="HC01_EST_VC14 symbol"></div> Weapons
      <div class="HC01_EST_VC14_val moe"></div>
      <div class="HC01_EST_VC14_val val"></div>
  </div>
</div>

<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://d3js.org/queue.v1.min.js"></script>
<script src="https://d3js.org/topojson.v1.min.js"></script>

<script>

var width = 960,
    height = 600,
    center = [width / 2, height / 2],
    defaultFill = "#e0e0e0";

    var baseColors = {
      "HC01_EST_VC04": d3.scale.linear().domain([0,180]).range(["#ffffff", "#8dd3c7"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC05": d3.scale.linear().domain([0,200]).range(["#ffffff", "#bc80bd"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC10": d3.scale.linear().domain([0,40]).range(["#ffffff", "#bebada"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC11": d3.scale.linear().domain([0,400]).range(["#ffffff", "#fb8072"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC12": d3.scale.linear().domain([0,5]).range(["#ffffff", "#80b1d3"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC13": d3.scale.linear().domain([0,180]).range(["#ffffff", "#fdb462"]).interpolate(d3.interpolateLab),
      "HC01_EST_VC14": d3.scale.linear().domain([0,70]).range(["#ffffff", "#b3de69"]).interpolate(d3.interpolateLab),
  };

var commuteById = d3.map();

var projection = d3.geo.mercator()
    .scale(62000)
	.center( [-73.85,40.71] )
    .translate([width / 2, height / 2]);

var path = d3.geo.path()
    .projection(projection);

var zoom = d3.behavior.zoom()
      .scaleExtent([1, 8])
      .on("zoom", move);

  var svg = d3.select("body #main-wrapper").append("svg")
          .attr("width", width)
          .attr("height", height)
        .append("g")
          .call(zoom);
      svg.on("wheel.zoom", null);
      svg.on("mousewheel.zoom", null);

      svg.append("rect")
    .attr("class", "overlay")
    .attr("width", width)
    .attr("height", height);

    svg.append("svg:image")
    .attr("xlink:href", "images/progress-anim.gif")
    .attr("id", "progress-image")
    .attr("width", 43)
    .attr("height", 11)
    .attr("x", width / 2)
    .attr("y", height / 2);

    var g = svg.append("g");

  var tooltip = d3.select("#tooltip")
 .attr("class", "tooltip")
 .style("opacity", 0);

 //Pre-select NB permit type in map
 //working on each type of selection
var CURR_SELECT = ["HC01_EST_VC04"];

queue()
    .defer(d3.json, "data/CD_topoJSON.json")
    .defer(d3.csv, "data/Crime_Felonies_C.csv", typeAndSet)
    .await(ready);


function ready(error, CD_topoJSON) {

      g.append("g")
          .attr("class", "collection")
          .selectAll("path")
            .data(topojson.feature(CD_topoJSON, CD_topoJSON.objects.collection).features)
          .enter().append("path")
            // .attr("class", function(d) { return classByGreatest(d.id); })
            .attr("d", path)

            .on("mouseover", function(d) {
             d3.select(this).classed("selected", true);
             tooltip.transition().duration(100)
               .style("opacity", 1)
             if (d3.event.pageX > (width - 200)) {
                 tooltip.style("left", (d3.event.pageX - 210) + "px");
             } else {
                 tooltip.style("left", (d3.event.pageX + 20) + "px")
                      .style("top", (d3.event.pageY -30) + "px");
             }
             if (d3.event.pageY > (height - 150)) {
                 tooltip.style("top", (d3.event.pageY -140) + "px");
             } else {
                 tooltip.style("top", (d3.event.pageY -30) + "px");
             }





  <body>

  </body>
</html>
